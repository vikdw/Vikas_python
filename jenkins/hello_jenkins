
def commit_msg = ""
 
pipeline {
    agent any

environment {
  commit_envmsg = "1st env value"
}
    stages {
        stage('Hello') {
            steps {
                echo 'Hello World'
                echo "${GIT_COMMIT}"
                script{
                def commitMessage = sh(script: 'git log -1 --pretty=%B', returnStdout: true).trim()
                echo "${commitMessage}"
                commit_msg = "${commitMessage}"
                }
                echo "${commit_msg}"
                echo "next is commit env mssge"
                echo "${commit_envmsg}"
                script{
                echo "${commit_msg}"
                commit_envmsg = ${commit_msg}
                echo "${commit_envmsg}"
                       }
                      
            }
        }
    stage('Print ENV Values') {
            when {
                 changelog 'build'
                 // expression { "${env.commit_envmsg}" =~ /build/ }
                 }
            steps {
                //echo "${commitMessage}"
                echo "${env.commit_envmsg}"
            }
        }

    }
}
